<!DOCTYPE html>
<html>
<head>
    <title>Automata</title>
    <meta charset="utf-8">
</head>
<body>
    <canvas></canvas>
    <script type="text/javascript">
const v=(  // canVas
 document.children[0].children[1].children[0]);
const t=(  // conText
 v.getContext('2d'));
const s=3; // pixel Size
const e=8; // world Exponent
const c=[  // Colors
 '#000','#7FFF00','#228B22','#BDB76B','#B22222','#FF8C00'];
const a=[  // Automaton
 [[1,.001,n=>1]],
 [[3,.01,n=>n[3]],
  [3,.02,n=>n[4]],
  [3,.01,n=>n[5]],
  [2,.005,n=>1]],
 [[3,.1,n=>n[3]],
  [3,.2,n=>n[4]],
  [3,.1,n=>n[5]],
  [3,.00005,n=>n[2]>=5]],
 [[4,.1,n=>1]],
 [[5,.1,n=>1]],
 [[0,.1,n=>1]],
];
const l=(  // Line Length
 Math.pow(2, e));
const w=(  // World
 new Array(l*l).fill(0));

v.width=l*s;
v.height=l*s;

function N(x,y) {  // Neighbores
 let n,i,j;
 n=new Array(6).fill(0);
 for(i=x-1;i<x+2;i++)
  for(j=y-1;j<y+2;j++)
   n[w[(i&l-1)+(j&l-1)*l]]++;
 n[w[y*l+x]]--;
 return n;
}
function T() {  // Tick
 let n,i,p,r;
 for(i=0;i<l*l;i++){
  p=Math.random();
  n=N(i&(l-1),i>>e);
  for(r of a[w[i]])
   if(r[1]>=p&&r[2](n)){
     w[i]=r[0];
     break;
   }
 }
 t.clearRect(0,0,l*s,l*s);
 for (i=0;i<l*l;i++) {
  t.fillStyle=c[w[i]];
  t.fillRect(s*(i&(l-1)),s*(i>>e),s,s);
 }
}
setInterval(T,33);
</script>
</body>
</html>
